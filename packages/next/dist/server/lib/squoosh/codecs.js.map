{"version":3,"sources":["../../../../server/lib/squoosh/codecs.ts"],"names":["fsp","promises","path","instantiateEmscriptenWasm","pathify","mozEnc","mozEncWasm","resolve","__dirname","mozDec","mozDecWasm","webpEnc","webpEncWasm","webpDec","webpDecWasm","pngEncDec","pngEncDecWasm","pngEncDecInit","default","readFile","oxipng","oxipngWasm","oxipngInit","resize","resizeWasm","resizeInit","rotateWasm","ImageData","global","resizeNameToIndex","name","Error","resizeWithAspect","input_width","input_height","target_width","target_height","width","height","Math","round","preprocessors","description","instantiate","buffer","method","premultiply","linearRGB","imageData","cleanup","defaultOptions","fitMethod","rotate","numRotations","degrees","sameDimensions","size","instance","WebAssembly","exports","memory","additionalPagesNeeded","ceil","byteLength","grow","view","Uint8ClampedArray","set","Buffer","from","slice","codecs","mozjpeg","extension","detectors","dec","enc","defaultEncoderOptions","quality","baseline","arithmetic","progressive","optimize_coding","smoothing","color_space","quant_table","trellis_multipass","trellis_opt_zero","trellis_opt_table","trellis_loops","auto_subsample","chroma_subsample","separate_chroma_quality","chroma_quality","autoOptimize","option","min","max","webp","target_size","target_PSNR","sns_strength","filter_strength","filter_sharpness","filter_type","partitions","segments","pass","show_compressed","preprocessing","autofilter","partition_limit","alpha_compression","alpha_filtering","alpha_quality","lossless","exact","image_hint","emulate_jpeg_size","thread_level","low_memory","near_lossless","use_delta_palette","use_sharp_yuv","decode","encode","opts","simplePng","Uint8Array","optimise","level"],"mappings":"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"}